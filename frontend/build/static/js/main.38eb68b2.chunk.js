(this["webpackJsonpcah-game"]=this["webpackJsonpcah-game"]||[]).push([[0],{123:function(e,t,a){e.exports=a(152)},124:function(e,t,a){},152:function(e,t,a){"use strict";a.r(t);var n=a(12),r=a(13),c=a(15),l=a(14),s=(a(124),a(107)),i=a(213),o=a(0),u=a.n(o),m=a(19),p=a(29),d=a(197),h=a(62);var g=function(e){return u.a.createElement(h.a,e,u.a.createElement("path",{d:"M12.007 0C6.12 0 1.1 4.27.157 10.08c-.944 5.813 2.468 11.45 8.054 13.312.19.064.397.033.555-.084.16-.117.25-.304.244-.5v-2.042c-3.33.735-4.037-1.56-4.037-1.56-.22-.726-.694-1.35-1.334-1.756-1.096-.75.074-.735.074-.735.773.103 1.454.557 1.846 1.23.694 1.21 2.23 1.638 3.45.96.056-.61.327-1.178.766-1.605-2.67-.3-5.462-1.335-5.462-6.002-.02-1.193.42-2.35 1.23-3.226-.327-1.015-.27-2.116.166-3.09 0 0 1.006-.33 3.3 1.23 1.966-.538 4.04-.538 6.003 0 2.295-1.5 3.3-1.23 3.3-1.23.445 1.006.49 2.144.12 3.18.81.877 1.25 2.033 1.23 3.226 0 4.607-2.805 5.627-5.476 5.927.578.583.88 1.386.825 2.206v3.29c-.005.2.092.393.26.507.164.115.377.14.565.063 5.568-1.88 8.956-7.514 8.007-13.313C22.892 4.267 17.884.007 12.008 0z"}))},b=a(219),f=a(195),E=a(108),v=a(99),y=a.n(v),O=a(222),j=function(e){return"gamestate/".concat(e,"/play-cards")},C=function(e){return("http:"===document.location.protocol?"ws:":"wss:")+"//".concat(window.location.host,"/rest/gamestate/").concat(e,"/state-websocket")},k=function(e){return"game/".concat(e,"/room-state")},w=a(4),x=function(e){var t=e.onElementClick;return u.a.createElement(u.a.Fragment,null,u.a.createElement(p.b,{to:"/game/list/my-games-in-progress"},u.a.createElement(O.a,{onClick:t},"My games in progress")),u.a.createElement(p.b,{to:"/game/list/open"},u.a.createElement(O.a,{onClick:t},"Open games")),u.a.createElement("a",{href:"user/logout"},u.a.createElement(O.a,{onClick:t},"Logout")))},S=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).state={open:!1},e.handleToggle=function(){e.setState((function(e){return{open:!e.open}}))},e.handleClose=function(t){e.anchorEl.contains(t.target)||e.setState({open:!1})},e}return Object(r.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.width,r=this.state.open;return Object(b.b)("md",n,!0)?u.a.createElement(x,null):u.a.createElement("div",null,u.a.createElement(f.a,{className:a.menuButton,color:"inherit","aria-label":"Menu",onClick:this.handleToggle,buttonRef:function(t){return e.anchorEl=t}},u.a.createElement(y.a,null)),u.a.createElement(E.a,{open:r,anchorEl:this.anchorEl,onClose:this.handleClose},u.a.createElement(x,{onElementClick:this.handleClose})))}}]),a}(u.a.Component),N=Object(b.a)()(Object(w.a)((function(e){return{menuButton:{marginRight:-12,marginLeft:2*e.spacing.unit}}}))(S)),R=a(71),I=a.n(R),P=a(198),W=a(153),B=a(16);var A=Object(B.b)((function(e){return{username:e.username}}))(Object(b.a)()(Object(w.a)((function(e){return{appbar:{color:e.palette.blackcard.text,backgroundColor:e.palette.blackcard.background},title:{flexGrow:1},user:{margin:e.spacing.unit},icon:{margin:e.spacing.unit,color:e.palette.grey[50]}}}))((function(e){var t=e.username,a=e.title,n=e.shortTitle,r=e.width,c=e.classes;return u.a.createElement("div",null,u.a.createElement(d.a,{position:"static",className:c.appbar},u.a.createElement(P.a,null,u.a.createElement(W.a,{variant:"h6",color:"inherit",className:c.user},t),u.a.createElement(W.a,{variant:"h6",color:"inherit",className:c.title},"xs"===r?n:a),u.a.createElement(W.a,null,u.a.createElement("a",{target:"blank",href:"https://github.com/J4RV"},u.a.createElement(g,{className:c.icon}))),u.a.createElement(W.a,null,u.a.createElement("a",{target:"blank",href:"https://store.cardsagainsthumanity.com"},u.a.createElement(I.a,{className:c.icon}))),u.a.createElement(N,null))))})))),z=a(214),L=a(8),G=a(203),M=a(202),D=a(220),T=a(22),F=a.n(T),H=function(e,t){var a=t.payload.msg;console.error(a);var n=e.errors.concat(a);return n.length>4&&n.splice(0,1),Object(L.a)(Object(L.a)({},e),{},{errors:n})},_=function(e){return{type:"PUSH_ERROR",payload:{msg:null!=e.response?e.response.data:e.toString()}}},U=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).state={name:"",password:"",waitingResponse:!1,createdSuccessfully:!1},e.handleSubmit=function(t){t.preventDefault(),e.setState(Object(L.a)(Object(L.a)({},e.state),{},{waitingResponse:!0}));var a={name:e.state.name,password:e.state.password};return F.a.post("game/create",a).then(e.createdSuccessfully).catch((function(t){e.props.pushError(t),e.setState(Object(L.a)(Object(L.a)({},e.state),{},{waitingResponse:!1}))})),!1},e.createdSuccessfully=function(){e.setState(Object(L.a)(Object(L.a)({},e.state),{},{createdSuccessfully:!0}))},e.handleChangeName=function(t){var a=Object.assign({},e.state);a.name=t.target.value.trim(),e.setState(a)},e.handleChangePass=function(t){var a=Object.assign({},e.state);a.password=t.target.value.trim(),e.setState(a)},e}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.history;return this.state.createdSuccessfully?u.a.createElement(m.a,{to:"/game/list/open"}):u.a.createElement("form",{className:t.form,onSubmit:this.handleSubmit},u.a.createElement(W.a,{variant:"h6",className:t.formLabel},"Create a new game"),u.a.createElement(D.a,{required:!0,fullWidth:!0,margin:"normal",label:"Room name",autoComplete:"roomName",s:!0,onChange:this.handleChangeName}),u.a.createElement(M.a,null,u.a.createElement(G.a,{margin:"normal",onClick:a.goBack,disabled:this.state.waitingResponse},"Cancel"),u.a.createElement(G.a,{margin:"normal",autoFocus:!0,type:"submit",variant:"contained",color:"primary",disabled:this.state.waitingResponse},"Create Game")))}}]),a}(o.Component),q=Object(B.b)(null,{pushError:_})(Object(w.a)((function(e){return{form:{padding:2*e.spacing.unit,maxWidth:360,marginLeft:"auto",marginRight:"auto"}}}))(U)),J=function(e){var t=e.className;return u.a.createElement(p.b,{to:"/game/list/open"},u.a.createElement(G.a,{className:t},"Back to games list"))},V=a(206),Y=Object(b.a)()(Object(w.a)((function(e){return{container:{}}}))((function(e){var t=e.state,a=e.classes,n=t.currRound;return t.maxRounds&&(n+=" of "+t.maxRounds),u.a.createElement(W.a,{align:"center"},u.a.createElement("div",{className:a.container},u.a.createElement("p",null,u.a.createElement("b",null,"Round:")," ",n),u.a.createElement("p",null,u.a.createElement("b",null,"Black cards left:")," ",t.blackCardsLeft),u.a.createElement("p",null,u.a.createElement("b",null,"White cards left:")," ",t.whiteCardsLeft)))}))),X=a(110),K=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).randomRotate=function(){e.setState({rotation:5*Math.random()-2.5})},e}return Object(r.a)(a,[{key:"render",value:function(){var e,t=this.props,a=t.text,n=t.isBlack,r=t.elevated,c=t.glowing,l=t.inHand,s=t.expansion,i=t.className,o=t.classes,m=t.style,p=Object(X.a)(t,["text","isBlack","elevated","glowing","inHand","expansion","className","classes","style"]);e=c?o.glowing:r?o.floating:o.inTable;var d=n?o.black:o.white;return u.a.createElement("div",Object.assign({style:Object(L.a)({transform:"rotate(".concat(this.state.rotation,"deg)")},m),className:"".concat(o.card," ").concat(o.text," ").concat(d," ").concat(e,"    \n        ").concat(l?o.inHand:"","\n        ").concat(i||"")},p),u.a.createElement("div",null,a),u.a.createElement("div",{className:o.expansion},s))}},{key:"componentWillMount",value:function(){this.randomRotate()}}]),a}(u.a.Component),Q=Object(b.a)()(Object(w.a)((function(e){return{card:{position:"relative",display:"inline-block",padding:e.spacing.unit,width:"8rem",height:"10rem",borderRadius:10,textAlign:"center",verticalAlign:"top",transformOrigin:"50% 80%",[e.breakpoints.down("sm")]:{padding:.5*e.spacing.unit,width:"6.4rem",height:"8rem",borderRadius:8}},inHand:{margin:"0 0 -8px 0"},text:{fontFamily:'"Open Sans", "Roboto", "Helvetica", "Arial", sans-serif',fontWeight:"600",fontSize:".8rem",whiteSpace:"pre-wrap",[e.breakpoints.down("sm")]:{fontSize:".64rem"}},black:{color:e.palette.blackcard.text,background:e.palette.blackcard.background},white:{color:e.palette.whitecard.text,background:e.palette.whitecard.background},expansion:{position:"absolute",bottom:e.spacing.unit,right:2*e.spacing.unit,marginLeft:e.spacing.unit,color:e.palette.expansion,fontSize:".8em",textAlign:"right",[e.breakpoints.down("sm")]:{right:e.spacing.unit}},inTable:{boxShadow:e.shadows[1]},floating:{boxShadow:e.shadows[10]},glowing:{boxShadow:e.lights.glow}}}))(K)),Z=a(101),$=a.n(Z),ee=a(204),te=function(e){var t=e.classes,a=e.width,n=e.playCards;return"sm"===a||"xs"===a?u.a.createElement(ee.a,{"aria-label":"Play selected cards",color:"primary",onClick:n,className:t.smallScreenButton},u.a.createElement($.a,null)):u.a.createElement(G.a,{variant:"contained",color:"primary",onClick:n,className:t.largeScreenButton},"Play cards")};te=Object(b.a)()(te);var ae=function(e){var t=e.state;if(t.myPlayer.id===t.currentCzarID)return null;var a=t.blackCardInPlay.blanks-t.myPlayer.whiteCardsInPlay.length;return 0===a?null:u.a.createElement(W.a,{variant:"h6",gutterBottom:!0},"Play ",a," cards")},ne=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).state={cardIndexes:[],errormsg:null},e.canPlayCards=function(){var t=e.props.gamestate,a=t.currentCzarID===t.myPlayer.id,n="Sinners playing their cards"===t.phase;return!a&&n},e.handleCardClick=function(t){if(e.canPlayCards()){var a=e.state.cardIndexes.slice();a.includes(t)?a.splice(a.indexOf(t),1):a.push(t),e.setState({cardIndexes:a})}},e.playCards=function(){var t=e.props.gamestate;F.a.post(j(t.id),{cardIndexes:e.state.cardIndexes}).then((function(t){e.setState({cardIndexes:[]})})).catch((function(t){return e.props.pushError(t)}))},e}return Object(r.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.gamestate,n=t.classes;return u.a.createElement("div",{className:n.hand},u.a.createElement(ae,{state:a}),u.a.createElement("div",{className:n.cardsInHand},a.myPlayer.hand.map((function(t,a){return u.a.createElement(Q,Object.assign({},t,{handIndex:a,elevated:!0,inHand:!0,glowing:e.state.cardIndexes.includes(a),onClick:function(){return e.handleCardClick(a)}}))}))),this.canPlayCards()?u.a.createElement(te,{playCards:this.playCards,classes:n}):null)}}]),a}(o.Component),re=Object(B.b)((function(){}),{pushError:_})(Object(b.a)()(Object(w.a)((function(e){return{hand:{maxWidth:800,boxShadow:e.shadows[8],background:"#0004",padding:e.spacing.unit,paddingTop:2*e.spacing.unit,marginLeft:"auto",marginRight:"auto",textAlign:"center"},cardsInHand:{textAlign:"center",paddingBottom:8},largeScreenButton:{marginTop:e.spacing.unit},smallScreenButton:{position:"fixed",right:e.spacing.unit,bottom:e.spacing.unit}}}))(ne))),ce=a(218),le=function(e){var t=e.point,a=e.classes;return u.a.createElement(ce.a,{title:t.text,className:a.pointInfo},u.a.createElement("div",null))},se=function(e){var t=e.player,a=e.itsYou,n=e.isCzar,r=e.classes;return u.a.createElement("div",{className:r.playerInfo},u.a.createElement("div",null,t.name," ",a?u.a.createElement("b",null,"(You)"):null),u.a.createElement("div",null,n?u.a.createElement("b",null,"Current Czar"):t.whiteCardsInPlay?u.a.createElement("span",null,"Waiting"):u.a.createElement("span",null,"Playing...")),u.a.createElement("div",{className:r.points},t.points.map((function(e){return u.a.createElement(le,{point:e,classes:r})}))))},ie=Object(b.a)()(Object(w.a)((function(e){return{container:{display:"flex",flexWrap:"wrap",[e.breakpoints.up("md")]:{position:"fixed",right:8,top:72}},playerInfo:{background:"#EEE8",color:"#111",margin:4,padding:4,borderRadius:3,boxShadow:e.shadows[8],flexGrow:1},pointInfo:{background:e.palette.blackcard.background,color:e.palette.blackcard.text,margin:2,width:14,height:16,borderRadius:3,boxShadow:e.shadows[2]},points:{display:"flex",flexWrap:"wrap"}}}))((function(e){var t=e.state,a=e.classes;return u.a.createElement(W.a,null,u.a.createElement("div",{className:a.container},t.players.map((function(e){return u.a.createElement(se,{player:e,itsYou:e.id===t.myPlayer.id,isCzar:e.id===t.currentCzarID,classes:a})}))))}))),oe=void 0,ue=function(e){var t=e.stateID,a=e.play,n=e.isCzar,r=e.classes,c=a.whiteCards;return null==c||0===c.length?null:u.a.createElement("div",{className:r.playerPlay},c.map((function(e){return u.a.createElement(Q,Object.assign({},e,{onClick:function(){return n&&function(e,t){var a=window.confirm("Is that your choice? Really?\n"+t.whiteCards.map((function(e){return"\u25cf "+e.text})).join("\n"));console.log({play:t,ok:a}),a&&F.a.post(function(e){return"gamestate/".concat(e,"/choose-winner")}(e),{winner:t.id}).catch((function(e){return oe.props.pushError(e)}))}(t,a)}}))})))},me=Object(B.b)((function(){}),{pushError:_})(Object(w.a)((function(e){return{playerPlay:{marginLeft:2*e.spacing.unit,marginBottom:2*e.spacing.unit,display:"inline-block"}}}))((function(e){var t=e.state,a=e.classes,n=t.myPlayer.id===t.currentCzarID;return t.sinnerPlays.length>0?u.a.createElement(u.a.Fragment,null,u.a.createElement(W.a,{variant:"h6",gutterBottom:!0},n?"Choose the winner":"Czar choosing winner..."),t.sinnerPlays.map((function(e){return u.a.createElement(ue,{stateID:t.id,play:e,isCzar:n,classes:a})}))):u.a.createElement(W.a,{variant:"h6",gutterBottom:!0},n?u.a.createElement("p",null,"You are the Czar!"):null,"Waiting for all players to play their cards...")}))),pe=function(e){var t=e.state,a=t.blackCardInPlay;return null==a?null:u.a.createElement("div",{className:"cah-table"},u.a.createElement(Q,Object.assign({},a,{isBlack:!0,style:{margin:".5rem"}})),u.a.createElement(me,{state:t}))},de=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).startWebsocket=function(t,a){var n=new WebSocket(C(t));n.onmessage=function(t){e.setState(JSON.parse(t.data)),a=5},n.onclose=function(){--a<=0?e.props.pushError("Could not reconnect to server."):(console.error("Server Connection was lost, reconnecting..."),setTimeout((function(){return e.startWebsocket(t,a)}),2e3/a))},n.onerror=function(t){e.props.pushError("Server Connection error: "+t.message),n.close()}},e}return Object(r.a)(a,[{key:"render",value:function(){if(null==this.state)return null;if("Finished"===this.state.phase){var e=this.state.players[0];for(var t in this.state.players){var a=this.state.players[t];console.log(a),a.points.length>e.points.length&&(e=a)}return u.a.createElement("div",{className:"cah-game"},u.a.createElement(ie,{state:this.state}),u.a.createElement(W.a,{align:"center"},u.a.createElement("h1",null,"Game finished!"),u.a.createElement("h2",null,"Winner: ",e.name),u.a.createElement("h3",null,"Black cards earned:"),e.points.map((function(e){return u.a.createElement("p",null,e.text)}))))}return u.a.createElement("div",{className:"cah-game"},u.a.createElement(W.a,{align:"center"},u.a.createElement("h2",null,this.state.phase)),u.a.createElement(ie,{state:this.state}),u.a.createElement(pe,{state:this.state}),u.a.createElement(re,{gamestate:this.state}),u.a.createElement(Y,{state:this.state}))}},{key:"componentWillMount",value:function(){var e=this.props.stateID;this.startWebsocket(e,5)}}]),a}(o.Component),he=Object(B.b)(null,{pushError:_})(de),ge=a(216),be=a(225),fe=a(201),Ee=a(224),ve=a(215),ye={PaperProps:{style:{maxHeight:224,width:250}}},Oe=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).state={expansions:["Loading..."],selected:[]},e.handleChangeSelect=function(t){var a=t.target.value;e.setState(Object(L.a)(Object(L.a)({},e.state),{},{selected:a})),e.props.onSelectedChange(a)},e}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.selected,n=t.expansions;return u.a.createElement(fe.a,{required:!0,className:e.select},u.a.createElement("select",{multiple:!0,hidden:!0,id:"selectedExpansions",name:"selectedExpansions"},a.map((function(e){return u.a.createElement("option",{selected:!0,key:e,value:e},e)}))),u.a.createElement(Ee.a,null,"Expansions"),u.a.createElement(ve.a,{multiple:!0,displayEmpty:!0,value:a,onChange:this.handleChangeSelect,renderValue:function(t){return u.a.createElement("div",{className:e.chips},t.map((function(t){return u.a.createElement(be.a,{key:t,label:t,className:e.chip})})))},MenuProps:ye},n.map((function(e){return u.a.createElement(O.a,{key:e,value:e},e)}))))}},{key:"componentWillMount",value:function(){var e=this;F.a.get("game/available-expansions").then((function(t){return e.setState(Object(L.a)(Object(L.a)({},e.state),{},{expansions:t.data}))}))}}]),a}(o.Component),je=Object(w.a)((function(e){return{select:{width:"100%",minHeight:36},chips:{display:"flex",flexWrap:"wrap"},chip:{margin:e.spacing.unit/4}}}))(Oe),Ce=a(205),ke=function(e){return u.a.createElement(G.a,{variant:"contained",color:"primary",type:"submit",className:e},"Start game")},we=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).state={gameID:e.props.gameID,expansions:[],handSize:10,randomFirstCzar:!0,maxRounds:10},e.handleSubmit=function(t){return t.preventDefault(),e.props.enoughPlayers?(console.log("Starting game with options",e.state),F.a.post("game/start",e.state).catch((function(t){return e.props.pushError(t)}))):console.error("Tried to start a game without enough players"),!1},e.handleHandSizeChange=function(t){var a=parseInt(t.target.value);a=Math.min(Math.max(a,0),30),e.setState(Object(L.a)(Object(L.a)({},e.state),{},{handSize:a}))},e.handleMaxRoundsChange=function(t){var a=parseInt(t.target.value);a=Math.max(a,0),e.setState(Object(L.a)(Object(L.a)({},e.state),{},{maxRounds:a}))},e.handleExpansionSelected=function(t){e.setState(Object(L.a)(Object(L.a)({},e.state),{},{expansions:t}))},e}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.enoughPlayers,n=this.state,r=n.handSize,c=n.randomFirstCzar,l=n.maxRounds;return u.a.createElement("div",{className:t.container},u.a.createElement("form",{className:t.form,onSubmit:this.handleSubmit},u.a.createElement(W.a,{variant:"h6",className:t.formLabel},"Game Options"),u.a.createElement(fe.a,{fullWidth:!0,margin:"normal"},u.a.createElement(je,{onSelectedChange:this.handleExpansionSelected})),u.a.createElement(fe.a,{required:!0,fullWidth:!0,margin:"normal"},u.a.createElement(D.a,{label:"Hand size",id:"handSize",name:"handSize",type:"number",onChange:this.handleHandSizeChange,value:r})),u.a.createElement(fe.a,{required:!0,fullWidth:!0,margin:"normal"},u.a.createElement(D.a,{label:"Max rounds",id:"maxRounds",name:"maxRounds",type:"number",onChange:this.handleMaxRoundsChange,value:l})),u.a.createElement(fe.a,{fullWidth:!0,margin:"normal"},u.a.createElement(Ce.a,{control:u.a.createElement(ge.a,{id:"randomFirstCzar",name:"randomFirstCzar",color:"primary",value:c}),label:"First Czar chosen randomly"})),u.a.createElement(J,{className:t.button}),a?u.a.createElement(ke,{className:t.button}):null))}}]),a}(o.Component),xe=Object(B.b)((function(){}),{pushError:_})(Object(w.a)((function(e){return{container:{padding:2*e.spacing.unit,maxWidth:480,marginLeft:"auto",marginRight:"auto"},formLabel:{textAlign:"left"},form:{marginTop:2*e.spacing.unit,display:"inline-block",width:"100%",textAlign:"right"},button:{margin:e.spacing.unit}}}))(we)),Se=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).updateState=function(){var t=e.props.match.params.gameID;F.a.get(k(t)).then((function(t){e.setState({room:t.data}),"Not started"===t.data.phase&&window.setTimeout(e.updateState,1e3)})).catch((function(t){return e.props.pushError(t)}))},e}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.username;if(null==this.state)return u.a.createElement(V.a,{className:t.loading});var n=this.state.room;if("Not started"!==n.phase)return u.a.createElement(he,{stateID:n.stateID});var r=n.players.length>2,c=n.owner===a;return u.a.createElement("div",{className:t.container},u.a.createElement(W.a,{variant:"h4",gutterBottom:!0},n.name),r?u.a.createElement(W.a,{variant:"h6",gutterBottom:!0},"Waiting for the game creator to start the game"):u.a.createElement(W.a,{variant:"h6",gutterBottom:!0},"Waiting for more players to join"),u.a.createElement(W.a,null,"Creator: ",n.owner,"."),u.a.createElement(W.a,{gutterBottom:!0},"Players: ",n.players.join(", "),"."),c?u.a.createElement(xe,{gameID:n.id,enoughPlayers:r}):u.a.createElement(J,{className:t.button}))}},{key:"componentWillMount",value:function(){this.updateState()}}]),a}(o.Component),Ne=Object(B.b)((function(e){return{username:e.username}}),{pushError:_})(Object(w.a)((function(e){return{container:{textAlign:"center",marginTop:2*e.spacing.unit},button:{margin:e.spacing.unit},loading:{margin:e.spacing.unit}}}))(Se)),Re=Object(w.a)((function(e){return{linkContainer:{display:"flex",alignItems:"center",justifyContent:"center"},icon:{margin:e.spacing.unit}}}))((function(e){var t=e.classes;return u.a.createElement("div",{className:t.linkContainer},u.a.createElement(W.a,null,u.a.createElement("a",{target:"blank",href:"https://github.com/J4RV"},u.a.createElement(g,{className:t.icon}))),u.a.createElement(W.a,null,u.a.createElement("a",{target:"blank",href:"https://store.cardsagainsthumanity.com"},u.a.createElement(I.a,{className:t.icon}))))})),Ie=function(e,t){var a=t.payload.response;if(200!==a.status)return Object(L.a)(Object(L.a)({},e),{},{validCookie:!1});var n=a.data;return Object(L.a)(Object(L.a)({},e),{},{validCookie:!0,userID:n.id,username:n.username})},Pe=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).state={username:"",password:"",disabled:!1},e.handleChangeUser=function(t){var a=Object.assign({},e.state);a.username=t.target.value.trim(),e.setState(a)},e.handleChangePass=function(t){var a=Object.assign({},e.state);a.password=t.target.value.trim(),e.setState(a)},e.handleSubmit=function(t,a){t.preventDefault(),e.setState(Object(L.a)(Object(L.a)({},e.state),{},{disabled:!0}));var n={username:e.state.username,password:e.state.password};return F.a.post(a,n).then((function(t){return e.props.onSubmitResponse(t)})).catch((function(t){e.setState(Object(L.a)(Object(L.a)({},e.state),{},{disabled:!1})),e.props.onError(t.response.data)})),!1},e}return Object(r.a)(a,[{key:"render",value:function(){var e=this,t=this.props.classes;return u.a.createElement("div",{className:t.container},u.a.createElement(W.a,{variant:"h2",gutterBottom:!0},"Cards Against Humanity"),u.a.createElement(W.a,{variant:"h4",gutterBottom:!0},"A party game for horrible people."),u.a.createElement("form",{className:t.form,onSubmit:function(t){return e.handleSubmit(t,"user/login")}},u.a.createElement(Q,{isBlack:!0,text:"I'm _ and my password is _.",expansion:"Security questions"}),u.a.createElement(D.a,{required:!0,fullWidth:!0,margin:"normal",label:"Username",autoComplete:"username",onChange:this.handleChangeUser}),u.a.createElement(D.a,{required:!0,fullWidth:!0,margin:"normal",label:"Password",type:"password",autoComplete:"password",onChange:this.handleChangePass}),u.a.createElement(fe.a,{margin:"normal",fullWidth:!0},u.a.createElement(G.a,{type:"submit",variant:"contained",color:"primary",onClick:function(t){return e.handleSubmit(t,"user/login")},disabled:this.state.disabled},"Log in")),u.a.createElement(fe.a,{margin:"normal",fullWidth:!0},u.a.createElement(G.a,{type:"button",variant:"contained",onClick:function(t){return e.handleSubmit(t,"user/register")},disabled:this.state.disabled},"Register")),u.a.createElement(Re,null)))}}]),a}(o.Component),We=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(r.a)(a,[{key:"componentWillMount",value:function(){var e=this;F.a.get("user/valid-cookie").then((function(t){return e.props.processLoginResponse(t)})).catch((function(t){return e.props.processLoginResponse(t)}))}},{key:"render",value:function(){var e=this.props,t=e.validCookie,a=e.processLoginResponse,n=e.pushError,r=e.classes;return null==t?u.a.createElement(V.a,null):t?this.props.children:u.a.createElement(Pe,{onSubmitResponse:a,onError:n,classes:r})}}]),a}(o.Component),Be=Object(B.b)((function(e){return{validCookie:e.validCookie}}),{processLoginResponse:function(e){return{type:"PROCESS_LOGIN_RESPONSE",payload:{response:e}}},pushError:_})(Object(w.a)((function(e){return{container:{textAlign:"center",marginTop:2*e.spacing.unit},form:{maxWidth:260,marginTop:2*e.spacing.unit,marginBottom:2*e.spacing.unit,padding:2*e.spacing.unit,display:"inline-block"}}}))(We)),Ae=a(207),ze=a(211),Le=a(210),Ge=a(208),Me=a(209),De=function(e){var t=e.username,a=e.game,n=e.joinGame;return a.players.includes(t)?u.a.createElement(p.b,{to:"/game/room/".concat(a.id)},u.a.createElement(G.a,{color:"primary",variant:"contained"},"Enter")):u.a.createElement(G.a,{color:"primary",variant:"contained",onClick:function(){return n(a.id)}},"Join")},Te=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).state={games:void 0,joinedGame:!1},e.refreshGames=function(){F.a.get(e.props.fetchGamesUrl).then((function(t){e.setState(Object(L.a)(Object(L.a)({},e.state),{},{games:t.data}))})).catch((function(t){return e.props.pushError(t)}))},e.joinGame=function(t){F.a.post("game/join",{id:t}).then(e.setState(Object(L.a)(Object(L.a)({},e.state),{},{joinedGame:t}))).catch((function(t){return e.props.pushError(t)}))},e}return Object(r.a)(a,[{key:"render",value:function(){var e=this;if(this.state.joinedGame)return u.a.createElement(m.a,{to:"/game/room/".concat(this.state.joinedGame)});var t=this.props.username,a=this.state.games;return null==a?u.a.createElement(V.a,null):0===a.length?u.a.createElement(W.a,{variant:"h6",align:"center"},"No games found"):u.a.createElement(Ae.a,null,u.a.createElement(Ge.a,null,u.a.createElement(Me.a,null,u.a.createElement(Le.a,{align:"left"},"Name"),u.a.createElement(Le.a,{align:"center"},"Owner"),u.a.createElement(Le.a,{align:"center"},"Actions"))),u.a.createElement(ze.a,null,a.map((function(a){return u.a.createElement(Me.a,{key:a.id},u.a.createElement(Le.a,{align:"left"},a.name),u.a.createElement(Le.a,{align:"center"},a.owner),u.a.createElement(Le.a,{align:"center"},u.a.createElement(De,{game:a,joinGame:e.joinGame,username:t})))}))))}},{key:"componentWillMount",value:function(){this.refreshGames()}}]),a}(o.Component),Fe=Object(B.b)((function(e){return{username:e.username}}),{pushError:_})(Te),He=a(112),_e=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props.classes;return u.a.createElement("div",{className:e.root},u.a.createElement(W.a,{variant:"h5",className:e.title},"My games in progress"),u.a.createElement(He.a,{className:e.tableContainer},u.a.createElement(Fe,{fetchGamesUrl:"game/list-in-progress"})))}}]),a}(o.Component),Ue=Object(B.b)(null,{pushError:_})(Object(b.a)()(Object(w.a)((function(e){return{root:{maxWidth:960-4*e.spacing.unit,marginTop:3*e.spacing.unit,marginLeft:"auto",marginRight:"auto",overflowX:"auto",padding:2*e.spacing.unit,[e.breakpoints.down("sm")]:{padding:e.spacing.unit}},tableContainer:{overflowX:"auto"},title:{textAlign:"center",marginBottom:2*e.spacing.unit},createBtn:{float:"right",marginTop:2*e.spacing.unit}}}))(_e))),qe=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props.classes;return u.a.createElement("div",{className:e.root},u.a.createElement(W.a,{variant:"h5",className:e.title},"Open games"),u.a.createElement(He.a,{className:e.tableContainer},u.a.createElement(Fe,{fetchGamesUrl:"game/list-open"})),u.a.createElement(p.b,{to:"/game/list/create"},u.a.createElement(G.a,{type:"button",className:e.createBtn},"Create new game")))}}]),a}(o.Component),Je=Object(B.b)(null,{pushError:_})(Object(b.a)()(Object(w.a)((function(e){return{root:{maxWidth:960-4*e.spacing.unit,marginTop:3*e.spacing.unit,marginLeft:"auto",marginRight:"auto",padding:2*e.spacing.unit,[e.breakpoints.down("sm")]:{padding:e.spacing.unit}},tableContainer:{overflowX:"auto"},title:{textAlign:"center",marginBottom:2*e.spacing.unit},createBtn:{float:"right",marginTop:2*e.spacing.unit}}}))(qe))),Ve=a(103),Ye=a.n(Ve),Xe=function(e){return u.a.createElement(f.a,{key:"close","aria-label":"Close",color:"inherit",onClick:e.onClick,className:e.className},u.a.createElement(Ye.a,null))},Ke=a(104),Qe=a.n(Ke),Ze=a(221),$e=a(212),et=a(109),tt=function(e,t){var a=t.payload.index,n=Object(et.a)(e.errors);return n.splice(a,1),Object(L.a)(Object(L.a)({},e),{},{errors:n})},at=Object(B.b)((function(e){return{errors:e.errors}}),{removeError:function(e){return{type:"REMOVE_ERROR",payload:{index:e}}}})(Object(w.a)((function(e){return{error:{color:e.palette.getContrastText(e.palette.error.dark),background:e.palette.error.dark,display:"flex",alignItems:"center"},icon:{marginRight:e.spacing.unit},message:{display:"flex",alignItems:"center"}}}))((function(e){var t=e.errors,a=e.children,n=e.removeError,r=e.classes;return u.a.createElement(u.a.Fragment,null,a,u.a.createElement(Ze.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:null!=t&&t.length>0},u.a.createElement($e.a,{className:r.error,message:t.map((function(e,t){return u.a.createElement("div",{className:r.message},u.a.createElement(Qe.a,{className:r.icon}),e,u.a.createElement(Xe,{onClick:function(){return n(t)}}))}))})))}))),nt=a(70),rt=a(79),ct=a.n(rt),lt=a(106),st=a.n(lt),it=a(105),ot=a.n(it),ut={validCookie:void 0,userID:void 0,username:void 0,errors:[]},mt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ut,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"PROCESS_LOGIN_RESPONSE":return Ie(e,t);case"PUSH_ERROR":return H(e,t);case"REMOVE_ERROR":return tt(e,t);default:return e}},pt=Object(s.a)({palette:{primary:ot.a,secondary:st.a,whitecard:{text:"#161616",background:"#FAFAFA"},blackcard:{text:"#FAFAFA",background:"#161616"},expansion:"#888888",type:"dark"},lights:{glow:"0 0 4px 2px ".concat(ct.a[100],", 0 0 24px 2px ").concat(ct.a[500])}}),dt=Object(m.f)((function(){return u.a.createElement(at,null,u.a.createElement(Be,null,u.a.createElement(A,null),u.a.createElement(m.b,{exact:!0,path:"/",render:function(){return u.a.createElement(m.a,{to:"/game/list/my-games-in-progress"})}}),u.a.createElement(m.b,{path:"/game/list/create",component:q}),u.a.createElement(m.b,{path:"/game/list/my-games-in-progress",component:Ue}),u.a.createElement(m.b,{path:"/game/list/open",component:Je}),u.a.createElement(m.b,{path:"/game/room/:gameID",component:Ne})))})),ht=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(r.a)(a,[{key:"render",value:function(){return u.a.createElement(p.a,null,u.a.createElement(i.a,{theme:pt},u.a.createElement(B.a,{store:Object(nt.b)(mt)},u.a.createElement(z.a,null),u.a.createElement(dt,null))))}}]),a}(o.Component),gt=a(11);a.n(gt).a.render(u.a.createElement(ht,null),document.getElementById("root"))}},[[123,1,2]]]);
//# sourceMappingURL=main.38eb68b2.chunk.js.map